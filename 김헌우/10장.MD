# 10장 프로세스와 스레드

# 10-1) 프로세스 개요

- 프로세스 : 실행 중인 프로그램
    - 보조기억장치에서 메모리에 적재, 프로세스를 생성
    - foreground, background process (ex : daemon, service)
- 프로세스 제어 블록
    - 프로세스 제어 블록(PCB)
        - 운영체제에서 실행 순서 관리, CPU 등의 자원 배분
        - 프로세스와 관련 있는 정보를 저장하는 자료구조
        - 프로세스와 생명주기가 동일
        - 구성은 다음과 같다
        - PID(process Id) : 프로세스 식별을 위한 고유 번호
        - register value
        - process status
        - cpu scheduling  정보
        - 메모리 관련 정보
        - 사용자 파일과 입출력장치 목록
- 문맥 교환
    - 프로세스를 번갈아가면 실행할 때 필요
    - 문맥 : 하나의 프로세스 수행을 재개하기 위하여 기억해야 할 정보
    - 문맥 교환 : 기존 프로세스의 문맥을 PCB에 백업
        - 새로운 프로세스를 실행하기 위하여 문맥을 PCB로 부터 복구하여 새로운 프로세스 실행
- 프로세스의 메모리 영역(in 사용자 영역)
    - 코드 영역
        - 텍스트 영역, 기계어로 이루어진 명령어가 저장, WRITE 금지
        - READ-ONLY
    - 데이터 영역
        - 프로그램이 실행되는 동안 유지할 데이터가 저장
        - ex) 전역 변수
    - 힙 영역
        - 프로그래머가 직접 할당 가능한 저장 공간
        - 메모리 공간 할당시 추후에 반환 필요 → X시 메모리 누수 발생
        - 낮은 곳에서 높은 곳으로 할당
    - 스택 영역
        - 데이터를 일시저장하는 공간
        - ex) 매개변수, 저장변수
        - 높은 곳에서 낮은 곳으로 할당

# 10-2) 프로세스의 상태와 계층구조

- 프로세스 상태
    - 생성 상태 : 프로세스 생성중일때 메모리에 적재되어 PCB에 할당
    - 준비 상태 : CPU 할당 받아 실행 가능하지만 차례가 아니라 대기 중일때
    - 실행 상태 : CPU 할당 → 실행 중인 상태
        - 타이머 interrupt 발생시 준비 상태로 복귀
        - 실행중 입출력장치 사용시 대기상태
    - 대기 상태 : 입출력장치의 작업을 기다리는 상태, 완료시 준비상태
    - 종료 상태 : 프로세스 종료
- 프로세스 계층 구조
    - Parent process(새 프로세스를 생성한 프로세스), Child Process(생성된 프로세스 by parent)
- 프로세스 생성 기법
    - fork : parent의 복사본을 child process 로 생성(상속 가능)
    - exec : child process가 자신의 메모리 공간을 다른 프로그램으로 교체(system call)
        - 코드 영역, 데이터 영역의 내용이 실행할 프로그램 내용으로 교체, 나머지 영역은 초기화
    - fork exec 을 반복하면서 프로세스 계층 구조 구성

# 10-3) 스레드

- Thread : 실행의 단위, 프로세스를 구성하는 실행의 흐름 단위
    - 하나의 process : 여러 thread 가지는 것이 가능
- 프로세스와 스레드
    - 기본 : 단일 스레드 프로세스
    - 멀티 스레드 프로세스 : 하나의 프로세스가 여러 명령어 동시에 처리, 스레드마다 각기 다른 코드 실행 가능
        - 프로세스의 스레드들은 실행에 필요한 최소한의 정보만을 유지한 채 프로세스 자원을 공유하며 실행
- 멀티 프로세스와 멀티 스레드
    - 멀티 프로세스
        - 여러 프로세스 동시에 실행
    - 멀티 스레드
        - 여러 스레드로 프로세스를 동시에 실행
    - 프로세스 간은 자원 공유 불가 but 스레드 간은 같은 프로세스 내의 자원 공유 가능
        - 여러 프로세스 병행 실행보다는 멀티 스레드가 효율적, 협력과 통신에 유리
            - but 스레드 하나에 문제가 생기면 프로세스 전체에 문제 발생 가능성
